extends layout

mixin createWorkflow(workflowName, workflowAbout)
  input(id="workflow-name", text=workflowName, value=workflowName, placeholder="name" label="workflow name" type=text)
  input(id="workflow-about", text=workflowAbout, value=workflowAbout, placeholder="about" type=text)

mixin createStep(position, name, doc, type, inputDoc, outputDoc, outputExtension, implementationFile, implementationLanguage)
  div(id="step-" + position)
    p(style='white-space:pre;')
      | Step:
      input(id="step-name", value=name, text=name, placeholder="id" label="workflow name" type="text")
      input(id="step-doc", value=doc, text=doc, placeholder="doc" type="text")
      select(id="step-type", placeholder="about")
        option(value='load', selected=true) load
        option(value='boolean-expression') boolean-expression
        option(value='write') write
    p(style='white-space:pre;')
      | Input:
      input(id="input-doc", value=inputDoc, text=inputDoc, placeholder="doc" label="input doc" type="text")
    p(style='white-space:pre;')
      | Output:
      input(id="output-doc", value=outputDoc, text=outputDoc, placeholder="doc" label="output doc" type="text")
      input(id="output-extension", value=outputExtension, text=outputExtension, placeholder="extension" label="output extension" type="text")
    p(style='white-space:pre;')
      | Implementation:
      if implementationFile
        label(id="implementation-file-existing", placeholder="implementation-file-existing")
          | #{implementationFile}
      input(id="implementation-file-" + position, value=implementationFile, text=implementationFile, placeholder="file", type="file")
      input(id="implementation-language-" + position, value=implementationLanguage, text=implementationLanguage, placeholder="language", type="text")

block content
  script(src='/javascripts/define.js')

  nav(class="navbar navbar-expand-md navbar-dark bg-info fixed-left")
    a(class="navbar-brand mx-auto")
      span(style="font-family: 'Sen', sans-serif; color: white;") pf
    button(class="navbar-toggler" type="button" data-toggle="collapse" data-target="#pfnav" aria-controls="pfnav" aria-expanded="false" aria-label="Toggle navigation")
      span(class="navbar-toggler-icon")
    div(class="collapse navbar-collapse" id="pfnav")
      ul(class="navbar-nav")
        li(class="nav-item")
          a(class="nav-link")
            svg(class="bi bi-house-fill" width="2em" height="2em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg")
              path(fill-rule="evenodd" d="M8 3.293l6 6V13.5a1.5 1.5 0 01-1.5 1.5h-9A1.5 1.5 0 012 13.5V9.293l6-6zm5-.793V6l-2-2V2.5a.5.5 0 01.5-.5h1a.5.5 0 01.5.5z" clip-rule="evenodd")
              path(fill-rule="evenodd" d="M7.293 1.5a1 1 0 011.414 0l6.647 6.646a.5.5 0 01-.708.708L8 2.207 1.354 8.854a.5.5 0 11-.708-.708L7.293 1.5z" clip-rule="evenodd")
        li(class="nav-item")
          a(class="nav-link")
            svg(class="bi bi-plus-circle-fill" width="2em" height="2em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg")
              path(fill-rule="evenodd" d="M16 8A8 8 0 110 8a8 8 0 0116 0zM8.5 4a.5.5 0 00-1 0v3.5H4a.5.5 0 000 1h3.5V12a.5.5 0 001 0V8.5H12a.5.5 0 000-1H8.5V4z" clip-rule="evenodd")

  div(class="container")
    p(style='white-space:pre;')
      | Workflow:
      if workflow
        +createWorkflow(workflow.name?workflow.name:"", workflow.about?workflow.about:"")
      else
        +createWorkflow("", "")
      div(id="steps")
        if workflow && workflow.steps && workflow.steps[0]
          each step in workflow.steps
            +createStep(step.position?step.position:"", step.name?step.name:"", step.doc?step.doc:"", step.type?step.type:"", step.inputs[0]&&step.inputs[0].doc?step.inputs[0].doc:"", step.outputs[0]&&step.outputs[0].doc?step.outputs[0].doc:"", step.outputs[0]&&step.outputs[0].extension?step.outputs[0].extension:"", step.implementation&&step.implementation.fileName?step.implementation.fileName:"", step.implementation&&step.implementation.language?step.implementation.language:"")
        else
          +createStep(1, "", "", "", "", "", "", "", "", "")


    a(onclick="addStep(); return false;") Add step
    a(onclick="createOrUpdateWorkflow(); return false;") Save
